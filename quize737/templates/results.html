{% extends "base_test.html" %}

{% block content %}
<fieldset>
    <legend>Результат теста</legend>
        <div class="block_none_light_up">
            <h1>{{user.profile.family_name}} {{user.profile.first_name}} {{user.profile.middle_name}}</h1>
        </div>
            <br>
        <div class="block_light_up">
            <div class="list-other_field">
                <span>Дата:</span>
            </div>
            <div class="list-other_field">
                <span class="mark_up">{{timestamp|date:"d.m.Y H:i:s"}} UTC</span>
            </div>
        </div>

        <div class="block_light_up">
            <div class="list-other_field">
                <span>Тип ВС:</span>
            </div>
            <div class="list-other_field">
                <span class="mark_up">{{ac_type}}</span>
            </div>
        </div>

        <div class="block_light_up">
            <div class="list-other_field">
                <span>Название теста:</span>
            </div>
            <div class="list-other_field">
                <span class="mark_up">{{quize_name}}</span>
            </div>
        </div>

        <div class="block_light_up">
            <div class="list-other_field">
                <span>Общее количество вопросов:</span>
            </div>
            <div class="list-other_field">
                <span class="mark_up">{{total_num_q}}</span>
            </div>
        </div>

        <div class="block_light_up">
            <div class="list-other_field">
                <span>Количество правильных ответов:</span>
            </div>
            <div class="list-other_field">
                <span class="mark_up">{{correct_q_num}}</span>
            </div>
        </div>

        <div class="block_light_up">
            <div class="list-other_field">
                <span>Минимально-необходимое количество баллов:</span>
            </div>
            <div class="list-other_field">
                <span class="mark_up">{{min_pass_score}}%</span>
            </div>
        </div>

        <div class="block_light_up">
            <div class="list-other_field">
                <span>Результать теста с учётом "веса" вопросов</span>
            </div>
            <div class="list-other_field">
                <span class="mark_up">{{total_result}}%</span>
            </div>
        </div>

        <div class="block_none_light_up">
                        {% if conclusion%}
                            <div class="list-other_field">
                                <span class="positive">ТЕСТ СДАН</span>
                            </div>
                        {% else %}
                            <div class="list-other_field">
                                <span class="negative">ТЕСТ НЕ СДАН</span>
                            </div>
                        {% endif %}
            </div>
            <br>
            <div class="block_none_light_up">
                <input type="submit" id="hide_show_butt" value="Показать ответы" onclick="show_answers()">
            </div>
            <br>
            <div id="answers" style="display: none;" >


                    {% for question in answers%}
                    <fieldset>
                        {% if question.conclusion == True%}
                            <legend>
                                <span class="positive">ПРАВИЛЬНЫЙ ОТВЕТ</span>
                            </legend>
                        {% else %}
                            <legend>
                                <span class="negative">НЕ ВЕРНЫЙ ОТВЕТ</span>
                            </legend>
                        {% endif %}

                        <div class="result_answers_question">{{question.question}}</div>

                        {% for answer in question.answers %}
                            {% if answer.valid == True %}
                                <div class="result_answers_correct">{{answer.option}}</div>
                            {% else %}
                                <div class="result_answers_wrong">{{answer.option}}</div>
                            {% endif %}
                        {% endfor %}
                        <br>
                        <div class="result_answers_question">Ответ Тестируемого:</div>
                        {% for user_answer in question.user_answer%}
                            <div class="result_answers_user_answer">{{user_answer}}</div>
                        {% endfor %}

                        </fieldset>
                    <br>
                    <br>
                    {% endfor %}


            </div>

                    <br>
            <div class="block_none_light_up">
                    <form method='get' action='{% url "start" %}'>
                    <input type="submit" value="На главную">
                    </form>
            </div>
        </fieldset>
    </div>


<script>
    let ans_block = document.getElementById("answers");
    let button = document.getElementById("hide_show_butt");
    function show_answers(event) {
        if (ans_block.style.display === 'none' ) {
                ans_block.style.display = 'block';
                button.setAttribute('value', 'Скрыть ответы');
            } else {
                ans_block.style.display = 'none';
                button.setAttribute('value', 'Показать ответы')
                }
    };

</script>

{% endblock %}