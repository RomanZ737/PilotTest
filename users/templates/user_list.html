{% extends "main_base.html" %}

{% block content %}
<fieldset>
    <legend><a href="{% url 'quize737:user_list' %}">ПИЛОТЫ</a>
        <span style="color: black;"> | </span>
        <a href="{% url 'quize737:new_user' %}">Добавить Пилота</a>
        <span style="color: black;"> | </span>
        <a href="{% url 'quize737:group_list' %}">Группы</a>
        <span style="color: black;"> | </span>
        <a href="{% url 'quize737:new_group' %}">Добавить Группу</a>

    </legend>
<!--    <h1><a href="{% url 'quize737:user_list' %}"> Пилоты </a> | <a href="{% url 'quize737:group_list' %}">Пруппы</a></h1>-->
    <div class="block-list">
        <div class="block_none_light_up">
        <div class="search-form">
            <form id="user_search" action="{% url 'quize737:user_list' %}" method="get">
                <input type="text" name="user_search" placeholder="Поиск пилота...">
                <input type="submit" value="Искать">
            </form>
        </div>


        <div class="filter-form">
            <form id="position_filter" name="position_filter" action="{% url 'quize737:user_list' %}" method="get">
                <div class="block_none_light_up">
                    <div class="filter_sign_position"> Квалификация: </div>
                    <select class="position_filter" name="position_filter">
                        {% for option in position_list %}
                            {% if filter_input %}
                                {% if option == filter_input.0 %}
                                    <option value="{{option}}" selected>{{option}}</option>
                                {% else %}
                                    <option value="{{option}}">{{option}}</option>
                                {% endif %}
                            {% else %}
                                {% if option == "Все" %}
                                    <option value="{{option}}" selected>{{option}}</option>
                                {% else %}
                                    <option value="{{option}}">{{option}}</option>
                                {% endif %}
                            {% endif %}
                        {% endfor %}
                    </select>
                    <div class="filter_sign_group"> Группа: </div>
                    <select class="position_filter" name="position_filter">
                        {% for group in group_list %}
                            {% if filter_input %}
                                {% if group.name == filter_input.1 %}
                                    <option value="{{group.name}}" selected>{{group.name}}</option>
                                {% else %}
                                    <option value="{{group.name}}">{{group.name}}</option>
                                {% endif %}
                            {% else %}
                                {% if group.name == "Все" %}
                                    <option value="{{group.name}}" selected>{{group.name}}</option>
                                {% else %}
                                    <option value="{{group.name}}">{{group.name}}</option>
                                {% endif %}
                            {% endif %}
                        {% endfor %}
                    </select>
                    <div class="filter_sign_group">Тест: </div>
                    <select class="position_filter" name="position_filter">
                        {% for test in tests_list %}
                            {% if filter_input %}
                                {% if test.name == filter_input.2 %}
                                    <option value="{{test.name}}" selected>{{test.name}}</option>
                                {% else %}
                                    <option value="{{test.name}}">{{test.name}}</option>
                                {% endif %}
                            {% else %}
                                {% if test.name == "Все" %}
                                    <option value="{{test.name}}" selected>{{test.name}}</option>
                                {% else %}
                                    <option value="{{test.name}}">{{test.name}}</option>
                                {% endif %}
                            {% endif %}
                        {% endfor %}
                    </select>
                    <input class="submit_filter" type="submit" value="Фильтр" form="position_filter">
                </div>

            </form>

        </div>
    </div>

        {% if no_search_results %}
        <div>
            <span style="color: rgb(209, 209,209);">{{results}}</span>
        </div>
        {% else %}
            {% for user in user_list %}
                {% if user.username != 'roman' %}
                   <div class="block_light_up">
                       <div class="list-fio">

                           <a href="{% url 'quize737:user_detales' user.id %}">{{user.profile.family_name}} {{user.profile.first_name}} {{user.profile.middle_name}}</a>
                       </div>
                       <span style="color: black;">|</span>
                       <div class="list-position">
                           <span class="theme_color">{{user.profile.position}}</span>
                       </div>
                       <span style="color: black;">|</span>
                       <div class="list-user_test_list">
                           {% if user_test_dict|get_item:user.username %}
                                <span>{{user_test_dict|get_item:user.username|join:";  "}}</span>
                           {% else %}
                                <span>Нет Тестов</span>
                           {% endif %}

                       </div>
                       <span style="color: black;">|</span>
                       <div class="list-edit">
                           <a href="{% url 'quize737:edit_user' user.id %}">Редактировать</a>
                       </div>
                       <span style="color: black;">|</span>
                       <div class="list-delete">
                           <a href="{% url 'quize737:del_user' user.id %}" onclick="return confirm('Удалить Пилота {{user.profile.family_name}} {{user.profile.first_name.0}}.{{user.profile.middle_name.0}}.?') || event.preventDefault()">Удалить</a>
                       </div>
                   </div>
                {% endif %}
            {% endfor %}
            <br>
            {% include "paginator_2.html" with page=user_list %}
        {% endif %}
    </div>
</fieldset>
{% endblock %}